Error: waiting for creation of Managed Cluster (Subscription: "f08b1fe3-f4f7-4c0a-bb51-d6a47cf1a81c"
│ Resource Group Name: "rg-hlg-aks"
│ Managed Cluster Name: "aks-hlg-tbd-eastus2-01"): Code="CreateVMSSAgentPoolFailed" Message="Agents are unable to resolve Kubernetes API server name. It's likely custom DNS server is not correctly configured, please see https://learn.microsoft.com/en-us/troubleshoot/azure/azure-kubernetes/error-code-k8sapiserverdnslookupfailvmextensionerror and https://aka.ms/aks/private-cluster#hub-and-spoke-with-custom-dns for more information. Details: VMSSAgentPoolReconciler retry failed: Category: ClientError; Code: VMExtensionProvisioningError; SubCode: K8SAPIServerDNSLookupFailVMExtensionError; Message: Agents are unable to resolve Kubernetes API server name. It's likely custom DNS server is not correctly configured, please see https://learn.microsoft.com/en-us/troubleshoot/azure/azure-kubernetes/error-code-k8sapiserverdnslookupfailvmextensionerror and https://aka.ms/aks/private-cluster#hub-and-spoke-with-custom-dns for more information. Details: instance 1 has extension error details : {vmssCSE error messages : {vmssCSE exit status=52, output= pages under /usr/share/man/id...\nPurging old database entries in /usr/share/man/zh_CN...\nProcessing manual pages under /usr/share/man/zh_CN...\nPurging old database entries in /usr/share/man/pt...\nProcessing manual pages under /usr/share/man/pt...\nPurging old database entries in /usr/share/man/sl...\nProcessing manual pages under /usr/share/man/sl...\nPurging old database entries in /usr/share/man/uk...\nProcessing manual pages under /usr/share/man/uk...\nPurging old database entries in /usr/share/man/ro...\nProcessing manual pages under /usr/share/man/ro...\nPurging old database entries in /usr/share/man/pl...\nProcessing manual pages under /usr/share/man/pl...\nPurging old database entries in /usr/share/man/ko...\nProcessing manual pages under /usr/share/man/ko...\nProcessing manual pages under /usr/local/man...\n/usr/bin/mandb: can't update index cache /var/cache/man/oldlocal/2617: No such file or directory\n4 man subdirectories contained newer manual pages.\n0 manual pages were added.\n0 stray cats were added.\n634 old database entries were purged.\n++ date\n+ echo 'man-db finished updates at Fri Jul 14 15:40:17 UTC 2023'\nman-db finished updates at Fri Jul 14 15:40:17 UTC 2023\nThe unit files have no installation config (WantedBy=, RequiredBy=, Also=,\nAlias= settings in the [Install] section, and DefaultInstance= for template\nunits). This means they are not meant to be enabled using systemctl.\n \nPossible reasons for having this kind of units are:\n• A unit may be statically enabled by being symlinked from another unit's\n .wants/ or .requires/ directory.\n• A unit's purpose may be to act as a helper for some other unit which has\n a requirement dependency on it.\n• A unit may be started when needed via activation (socket, path, timer,\n D-Bus, udev, scripted systemctl call, ...).\n• In case of template units, the unit is meant to be enabled with some\n instance name specified.\n+ systemctl enable apt-daily.timer apt-daily-upgrade.timer\nCreated symlink /etc/systemd/system/timers.target.wants/apt-daily.timer ? /lib/systemd/system/apt-daily.timer.\nCreated symlink /etc/systemd/system/timers.target.wants/apt-daily-upgrade.timer ? /lib/systemd/system/apt-daily-upgrade.timer.\n+ systemctl restart --no-block apt-daily.timer apt-daily-upgrade.timer\n+ systemctl restart --no-block apt-daily.service\n+ echo 'Custom script finished. API server connection check code:' 52\nCustom script finished. API server connection check code: 52\n+ aptmarkWALinuxAgent unhold\n++ date\n++ date\n++ hostname\n+ echo Fri Jul 14 15:40:17 UTC 2023,aks-aksdnphxa-22403919-vmss000001, endcustomscript\n+ mkdir -p /opt/azure/containers\n++ hostname\n+ echo Fri Jul 14 15:40:17 UTC 2023,aks-aksdnphxa-22403919-vmss000001, startAptmarkWALinuxAgent unhold\nFri Jul 14 15:40:17 UTC 2023,aks-aksdnphxa-22403919-vmss000001, startAptmarkWALinuxAgent unhold\n+ wait_for_apt_locks\n+ fuser /var/lib/dpkg/lock /var/lib/apt/lists/lock /var/cache/apt/archives/lock\n+ touch /opt/azure/containers/provision.complete\n+ exit 52, error=}}; InnerMessage: ; Dependency: Microsoft.Compute/VirtualMachineScaleSet; AKSTeam: "
│ 
│   with module.aks_hlg.azurerm_kubernetes_cluster.main,
│   on modules/terraform-azurerm-aks/main.tf line 90, in resource "azurerm_kubernetes_cluster" "main":
│   90: resource "azurerm_kubernetes_cluster" "main" {